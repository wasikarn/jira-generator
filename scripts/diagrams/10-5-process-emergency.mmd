flowchart TD
    A_ADMIN(["Admin<br/>Human"])
    C_TRIGGER["TriggerEmergency"]
    E_P0["P0EmergencyEvent"]
    EXT_PUSHER[("Pusher")]
    E_RECEIVED["EmergencyReceived"]
    POL_IC{{"InterruptController:<br/>Immediate override"}}
    E_INTERRUPTED["AdInterrupted<br/>reason: P0_emergency"]
    C_PLAY["PlayEmergencyCreative"]
    RM_CREATIVE[/"Emergency Creative<br/>URL + duration"/]
    E_PLAYED["EmergencyPlayed"]
    POL_MG{{"Schedule Make-Good<br/>for interrupted ad"}}
    AGG_MG["MakeGoodRecord"]
    E_MG["MakeGoodScheduled"]
    POL_END{{"After duration ends<br/>Resume normal sequence"}}
    E_RESUMED["PlaybackResumed"]

    A_ADMIN --> C_TRIGGER
    C_TRIGGER --> E_P0
    E_P0 e1@--> EXT_PUSHER
    EXT_PUSHER --> E_RECEIVED
    e1@{ animation: fast }
    E_RECEIVED --> POL_IC
    POL_IC --> E_INTERRUPTED
    E_INTERRUPTED --> C_PLAY
    RM_CREATIVE -.-> C_PLAY
    C_PLAY --> E_PLAYED
    E_PLAYED --> POL_END
    POL_END --> E_RESUMED

    E_INTERRUPTED --> POL_MG
    POL_MG --> AGG_MG
    AGG_MG --> E_MG

    %% Events - Orange
    style E_P0 fill:#FF8C00,stroke:#CC7000,color:#fff
    style E_RECEIVED fill:#FF8C00,stroke:#CC7000,color:#fff
    style E_INTERRUPTED fill:#FF8C00,stroke:#CC7000,color:#fff
    style E_PLAYED fill:#FF8C00,stroke:#CC7000,color:#fff
    style E_RESUMED fill:#FF8C00,stroke:#CC7000,color:#fff
    style E_MG fill:#FF8C00,stroke:#CC7000,color:#fff

    %% Commands - Blue
    style C_TRIGGER fill:#4169E1,stroke:#2850B0,color:#fff
    style C_PLAY fill:#4169E1,stroke:#2850B0,color:#fff

    %% Aggregates - Yellow
    style AGG_MG fill:#FFD700,stroke:#CCB000,color:#333

    %% Policies - Lilac
    style POL_IC fill:#C8A2C8,stroke:#9B7A9B,color:#333
    style POL_MG fill:#C8A2C8,stroke:#9B7A9B,color:#333
    style POL_END fill:#C8A2C8,stroke:#9B7A9B,color:#333

    %% Actor - Light Yellow
    style A_ADMIN fill:#FFFACD,stroke:#CCC88A,color:#333

    %% Read Model - Green
    style RM_CREATIVE fill:#90EE90,stroke:#6BBE6B,color:#333

    %% External - Pink
    style EXT_PUSHER fill:#FFB6C1,stroke:#CC929A,color:#333
