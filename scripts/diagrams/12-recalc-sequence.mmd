sequenceDiagram
    participant OW as Owner/Admin
    participant BE as Backend
    participant AD as Ad Decisioning
    participant PU as Pusher
    participant PL as Player

    rect rgb(240, 240, 240)
        Note over OW,BE: Event: Ad Approved
        OW->>BE: Approve new campaign ad
        BE->>BE: Save Advertisement (status=approved)
        BE->>AD: Trigger re-calc (event-driven)
    end

    rect rgb(255, 247, 200)
        Note over AD: Re-calculate Schedule
        AD->>AD: Fetch current PlaySchedules
        AD->>AD: Run Algorithm v3 (Steps 0-6)
        AD->>AD: Apply pacing filter
        AD->>BE: Save ScreenSchedule (v+1)
    end

    rect rgb(200, 255, 200)
        Note over BE,PL: Notify + Sync
        BE->>PU: schedule-updated {version, tier}
        PU->>PL: Push notification
        PL->>BE: GET /v2/screen-schedule?since_version=N
        BE->>PL: New schedule + creative manifest
        Note over PL: Download new creative from CDN
        Note over PL: Update local schedule
        Note over PL: Play new ad in next loop
    end
