sequenceDiagram
    participant BE as Backend
    participant PU as Pusher
    participant PL as Player
    rect rgb(240, 240, 240)
        Note over BE: Ad Decisioning v3: Step 0<br/>Reserve ExactTimeSpot at 14:30:00 ±5s
        BE->>BE: Save ScreenSchedule (v43)<br/>with ET spot at reserved position
        BE->>PU: schedule-updated {version:43}
    end
    PU->>PL: Inbox: 43 > 42? ✓
    PL->>BE: GET /v2/screen-schedule?since_version=42
    BE->>PL: {version:43, items:[...with ET spot]}
    Note over PL: Pre-download ET creative<br/>Interrupt Controller: arm timer for 14:30:00
    rect rgb(255, 230, 230)
        Note over PL: 14:30:00 — ET trigger (±5s tolerance)
        Note over PL: IC: stop current P2-P4 creative<br/>→ play ET spot immediately
    end
    Note over PL: PoP: interrupted ad<br/>{interrupted: true, play_duration: 8s,<br/>interrupt_reason: "P1_exact_time"}
    rect rgb(200, 255, 200)
        Note over PL: ET spot plays (15s)
        Note over PL: PoP: ET spot played<br/>{type: "campaign", priority: "P1-ET"}
    end
    Note over PL: Resume NEXT item in schedule
    PL->>BE: POST /v2/proof-of-play (batch flush)
    Note over BE: MakeGoodRecord created<br/>for interrupted ad → compensate next cycle
