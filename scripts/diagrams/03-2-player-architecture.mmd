flowchart LR
    subgraph T1["Track 1: Campaign Creatives"]
        direction TB
        T1_pad[ ]:::spacer ~~~ S1
        S1["Loop rotation +<br/>guaranteed interrupts"]
        S2["SchedulePlayComponent"]
        S3["TimeSlotComponent"]
        S1 e1@--> S2 e2@--> S3
    end
    subgraph T2["Track 2: House Content"]
        direction TB
        T2_pad[ ]:::spacer ~~~ P1
        P1["Sequential playback<br/>(when no schedule ad)"]
        P2["PlaylistComponent"]
        P1 e3@--> P2
    end
    subgraph DF["Data Flow"]
        direction TB
        DF_pad[ ]:::spacer ~~~ D1
        D1["Pusher events<br/>→ re-fetch schedules"]
        D2["Poll 5 min<br/>→ re-fetch playlists"]
        D3[("localStorage<br/>schedules, playlists,<br/>retryQueue")]
        D4["Tauri plugin<br/>→ download media"]
        D1 e4@--> D3
        D2 e5@--> D3
    end
    T1 ~~~ T2
    T2 ~~~ DF
    e1@{ animation: fast }
    e2@{ animation: fast }
    e3@{ animation: fast }
    e4@{ animation: slow }
    e5@{ animation: slow }
    classDef spacer fill:none,stroke:none,color:transparent
    style T1 fill:#fff3cd,stroke:#ffc107
    style T2 fill:#d4edda,stroke:#28a745
    style DF fill:#cce5ff,stroke:#004085
